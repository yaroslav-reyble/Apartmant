!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/platform-browser"),require("rxjs")):"function"==typeof define&&define.amd?define("@ngx-meta/core",["exports","@angular/core","@angular/platform-browser","rxjs"],e):e(((t=t||self)["ngx-meta"]=t["ngx-meta"]||{},t["ngx-meta"].core={}),t.ng.core,t.ng.platformBrowser,t.rxjs)}(this,(function(t,e,i,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var o;function n(t,e,i,a){var o,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,a);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(r=(n<3?o(r):n>3?o(e,i,r):o(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r}function r(t,e){return function(i,a){e(i,a,t)}}function s(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}(o=t.PageTitlePositioning||(t.PageTitlePositioning={}))[o.AppendPageTitle=0]="AppendPageTitle",o[o.PrependPageTitle=10]="PrependPageTitle";var l=function(){},c=function(){function e(e){void 0===e&&(e={pageTitlePositioning:t.PageTitlePositioning.PrependPageTitle,defaults:{}}),this.providedSettings=e}return Object.defineProperty(e.prototype,"settings",{get:function(){return this.providedSettings},enumerable:!0,configurable:!0}),e}(),p=function(){function o(t,e,i){this.loader=t,this.title=e,this.meta=i,this.settings=t.settings,this.isMetaTagSet={}}return o.prototype.setTitle=function(t,e){var i=this;void 0===e&&(e=!1),(t?this.callback(t):a.of("")).subscribe((function(t){var o="";t?!e&&i.settings.pageTitleSeparator&&i.settings.applicationName?i.callback(i.settings.applicationName).subscribe((function(e){o=e?i.getTitleWithPositioning(t,e):t,i.updateTitle(o)})):i.updateTitle(t):(i.settings.defaults&&i.settings.defaults.title?i.callback(i.settings.defaults.title):a.of("")).subscribe((function(t){!e&&i.settings.pageTitleSeparator&&i.settings.applicationName?i.callback(i.settings.applicationName).subscribe((function(e){o=e?i.getTitleWithPositioning(t,e):t,i.updateTitle(o)})):i.updateTitle(t)}))}))},o.prototype.setTag=function(t,e){var i=this;if("title"===t)throw new Error("Attempt to set "+t+' through "setTag": "title" is a reserved tag name. Please use `MetaService.setTitle` instead.');var o=e||(this.settings.defaults&&this.settings.defaults[t]?this.settings.defaults[t]:"");("og:locale"!==t&&"og:locale:alternate"!==t?this.callback(o):a.of(o)).subscribe((function(e){i.updateTag(t,e)}))},o.prototype.update=function(t,e){var i=this;if(e){if(e.disabled)return void this.update(t);this.setTitle(e.title,e.override),Object.keys(e).forEach((function(t){var a=e[t];if("title"!==t&&"override"!==t){if("og:locale"===t)a=a.replace(/-/g,"_");else if("og:locale:alternate"===t){var o=e["og:locale"];return void i.updateLocales(o,e[t])}i.setTag(t,a)}}))}else{var a=this.settings.defaults&&this.settings.defaults.title||this.settings.applicationName;this.setTitle(a,!0)}this.settings.defaults&&Object.keys(this.settings.defaults).forEach((function(t){var a=i.settings.defaults[t];if(!(e&&(t in i.isMetaTagSet||t in e)||"title"===t||"override"===t)){if("og:locale"===t)a=a.replace(/-/g,"_");else if("og:locale:alternate"===t){var o=e?e["og:locale"]:void 0;return void i.updateLocales(o,a)}i.setTag(t,a)}}));var o=(""+(this.settings.applicationUrl?this.settings.applicationUrl:"/")+t).replace(/(https?:\/\/)|(\/)+/g,"$1$2").replace(/\/$/g,"");this.setTag("og:url",o||"/")},o.prototype.removeTag=function(t){this.meta.removeTag(t)},o.prototype.callback=function(t){if(this.settings.callback){var e=this.settings.callback(t);return(i=e)&&"function"==typeof i.subscribe?e:function(t){return!!t&&"function"==typeof t.then}(e)?a.from(e):a.of(e)}var i;return a.of(t)},o.prototype.getTitleWithPositioning=function(e,i){switch(this.settings.pageTitlePositioning){case t.PageTitlePositioning.AppendPageTitle:return i+String(this.settings.pageTitleSeparator)+e;case t.PageTitlePositioning.PrependPageTitle:return e+String(this.settings.pageTitleSeparator)+i;default:throw new Error("Invalid pageTitlePositioning specified ["+this.settings.pageTitlePositioning+"]!")}},o.prototype.updateTitle=function(t){this.title.setTitle(t),this.meta.updateTag({property:"og:title",content:t})},o.prototype.updateLocales=function(t,e){var i=this,a=t||(this.settings.defaults?this.settings.defaults["og:locale"]:"");a&&this.settings.defaults&&(this.settings.defaults["og:locale"]=a.replace(/_/g,"-")),this.meta.getTags('property="og:locale:alternate"').forEach((function(t){i.meta.removeTagElement(t)})),a&&e&&e.split(",").forEach((function(t){a.replace(/-/g,"_")!==t.replace(/-/g,"_")&&i.meta.addTag({property:"og:locale:alternate",content:t.replace(/-/g,"_")})}))},o.prototype.updateTag=function(t,e){if(0===t.lastIndexOf("og:",0)?this.meta.updateTag({property:t,content:"og:locale"===t?e.replace(/-/g,"_"):e}):this.meta.updateTag({name:t,content:e}),this.isMetaTagSet[t]=!0,"description"===t)this.meta.updateTag({property:"og:description",content:e});else if("author"===t)this.meta.updateTag({property:"og:author",content:e});else if("publisher"===t)this.meta.updateTag({property:"og:publisher",content:e});else if("og:locale"===t){var i=this.settings.defaults?this.settings.defaults["og:locale:alternate"]:"";this.updateLocales(e,i),this.isMetaTagSet["og:locale:alternate"]=!0}else if("og:locale:alternate"===t){var a=this.meta.getTag('property="og:locale"').content;this.updateLocales(a,e),this.isMetaTagSet["og:locale"]=!0}},o.ctorParameters=function(){return[{type:l},{type:i.Title},{type:i.Meta}]},o=n([e.Injectable(),s("design:paramtypes",[l,i.Title,i.Meta])],o)}(),g=function(){function t(t){this.meta=t}return t.prototype.canActivate=function(t,e){var i=e.url,a=t.hasOwnProperty("data")?t.data.meta:void 0;return this.meta.update(i,a),!0},t.prototype.canActivateChild=function(t,e){return this.canActivate(t,e)},t.ctorParameters=function(){return[{type:p}]},t=n([e.Injectable(),s("design:paramtypes",[p])],t)}(),u=function(){return new c},f=function(){function t(t){if(t)throw new Error("MetaModule already loaded; import in root module only.")}var i;return i=t,t.forRoot=function(t){return void 0===t&&(t={provide:l,useFactory:u}),{ngModule:i,providers:[t,g,p]}},t.ctorParameters=function(){return[{type:t,decorators:[{type:e.Optional},{type:e.SkipSelf}]}]},t=i=n([e.NgModule(),r(0,e.Optional()),r(0,e.SkipSelf()),s("design:paramtypes",[t])],t)}();t.MetaGuard=g,t.MetaLoader=l,t.MetaModule=f,t.MetaService=p,t.MetaStaticLoader=c,t.metaFactory=u,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-meta-core.umd.min.js.map