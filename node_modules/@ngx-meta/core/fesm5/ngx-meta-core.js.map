{"version":3,"file":"ngx-meta-core.js","sources":["ng:/@ngx-meta/core/models/page-title-positioning.ts","ng:/@ngx-meta/core/meta.loader.ts","ng:/@ngx-meta/core/util.ts","ng:/@ngx-meta/core/meta.service.ts","ng:/@ngx-meta/core/meta.guard.ts","ng:/@ngx-meta/core/meta.module.ts"],"names":["observableOf","observableFrom","tslib_1.__param"],"mappings":"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","sourcesContent":["export enum PageTitlePositioning {\n  /**\n   * append page title after application name\n   */\n  AppendPageTitle = 0,\n  /**\n   * prepend page title before application name\n   */\n  PrependPageTitle = 10\n}\n","import { MetaSettings } from './models/meta-settings';\nimport { PageTitlePositioning } from './models/page-title-positioning';\n\nexport abstract class MetaLoader {\n  abstract get settings(): MetaSettings;\n}\n\nexport class MetaStaticLoader implements MetaLoader {\n  get settings(): MetaSettings {\n    return this.providedSettings;\n  }\n\n  constructor(\n    private readonly providedSettings: MetaSettings = {\n      pageTitlePositioning: PageTitlePositioning.PrependPageTitle,\n      defaults: {}\n    }\n  ) {}\n}\n","import { Observable } from 'rxjs';\n\nexport const isPromise = (obj: any): obj is Promise<any> => !!obj && typeof obj.then === 'function';\n\nexport const isObservable = (obj: any | Observable<any>): obj is Observable<any> => !!obj && typeof obj.subscribe === 'function';\n","import { Injectable } from '@angular/core';\nimport { Meta, Title } from '@angular/platform-browser';\nimport { from as observableFrom, Observable, of as observableOf } from 'rxjs';\n\nimport { MetaLoader } from './meta.loader';\nimport { MetaSettings } from './models/meta-settings';\nimport { PageTitlePositioning } from './models/page-title-positioning';\nimport { isObservable, isPromise } from './util';\n\n@Injectable()\nexport class MetaService {\n  protected readonly settings: MetaSettings;\n  private readonly isMetaTagSet: any;\n\n  constructor(readonly loader: MetaLoader, private readonly title: Title, private readonly meta: Meta) {\n    this.settings = loader.settings;\n    this.isMetaTagSet = {};\n  }\n\n  setTitle(title: string, override = false): void {\n    const title$ = title ? this.callback(title) : observableOf('');\n\n    title$.subscribe((res: string) => {\n      let fullTitle = '';\n\n      if (!res) {\n        const defaultTitle$ =\n          this.settings.defaults && this.settings.defaults.title ? this.callback(this.settings.defaults.title) : observableOf('');\n\n        defaultTitle$.subscribe((defaultTitle: string) => {\n          if (!override && this.settings.pageTitleSeparator && this.settings.applicationName) {\n            this.callback(this.settings.applicationName).subscribe((applicationName: string) => {\n              fullTitle = applicationName ? this.getTitleWithPositioning(defaultTitle, applicationName) : defaultTitle;\n              this.updateTitle(fullTitle);\n            });\n          } else {\n            this.updateTitle(defaultTitle);\n          }\n        });\n      } else if (!override && this.settings.pageTitleSeparator && this.settings.applicationName) {\n        this.callback(this.settings.applicationName).subscribe((applicationName: string) => {\n          fullTitle = applicationName ? this.getTitleWithPositioning(res, applicationName) : res;\n          this.updateTitle(fullTitle);\n        });\n      } else {\n        this.updateTitle(res);\n      }\n    });\n  }\n\n  setTag(key: string, value: string): void {\n    if (key === 'title') {\n      throw new Error(\n        `Attempt to set ${key} through \"setTag\": \"title\" is a reserved tag name. ` + 'Please use `MetaService.setTitle` instead.'\n      );\n    }\n\n    const cur = value || (this.settings.defaults && this.settings.defaults[key] ? this.settings.defaults[key] : '');\n\n    const value$ = key !== 'og:locale' && key !== 'og:locale:alternate' ? this.callback(cur) : observableOf(cur);\n\n    value$.subscribe((res: string) => {\n      this.updateTag(key, res);\n    });\n  }\n\n  update(currentUrl: string, metaSettings?: any): void {\n    if (!metaSettings) {\n      const fallbackTitle = this.settings.defaults\n        ? this.settings.defaults.title || this.settings.applicationName\n        : this.settings.applicationName;\n\n      this.setTitle(fallbackTitle, true);\n    } else {\n      if (metaSettings.disabled) {\n        this.update(currentUrl);\n\n        return;\n      }\n\n      this.setTitle(metaSettings.title, metaSettings.override);\n\n      Object.keys(metaSettings).forEach(key => {\n        let value = metaSettings[key];\n\n        if (key === 'title' || key === 'override') {\n          return;\n        } else if (key === 'og:locale') {\n          value = value.replace(/-/g, '_');\n        } else if (key === 'og:locale:alternate') {\n          const currentLocale = metaSettings['og:locale'];\n          this.updateLocales(currentLocale, metaSettings[key]);\n\n          return;\n        }\n\n        this.setTag(key, value);\n      });\n    }\n\n    if (this.settings.defaults) {\n      Object.keys(this.settings.defaults).forEach(key => {\n        let value = this.settings.defaults[key];\n\n        if ((metaSettings && (key in this.isMetaTagSet || key in metaSettings)) || key === 'title' || key === 'override') {\n          return;\n        } else if (key === 'og:locale') {\n          value = value.replace(/-/g, '_');\n        } else if (key === 'og:locale:alternate') {\n          const currentLocale = metaSettings ? metaSettings['og:locale'] : undefined;\n          this.updateLocales(currentLocale, value);\n\n          return;\n        }\n\n        this.setTag(key, value);\n      });\n    }\n\n    const baseUrl = this.settings.applicationUrl ? this.settings.applicationUrl : '/';\n    const url = `${baseUrl}${currentUrl}`.replace(/(https?:\\/\\/)|(\\/)+/g, '$1$2').replace(/\\/$/g, '');\n\n    this.setTag('og:url', url ? url : '/');\n  }\n\n  removeTag(key: string): void {\n    this.meta.removeTag(key);\n  }\n\n  private callback(value: string): Observable<string> {\n    if (this.settings.callback) {\n      const value$ = this.settings.callback(value);\n\n      if (!isObservable(value$)) {\n        return isPromise(value$) ? observableFrom(value$) : observableOf(value$);\n      }\n\n      return value$;\n    }\n\n    return observableOf(value);\n  }\n\n  private getTitleWithPositioning(title: string, applicationName: string): string {\n    switch (this.settings.pageTitlePositioning) {\n      case PageTitlePositioning.AppendPageTitle:\n        return applicationName + String(this.settings.pageTitleSeparator) + title;\n      case PageTitlePositioning.PrependPageTitle:\n        return title + String(this.settings.pageTitleSeparator) + applicationName;\n      default:\n        throw new Error(`Invalid pageTitlePositioning specified [${this.settings.pageTitlePositioning}]!`);\n    }\n  }\n\n  private updateTitle(title: string): void {\n    this.title.setTitle(title);\n    this.meta.updateTag({\n      property: 'og:title',\n      content: title\n    });\n  }\n\n  private updateLocales(currentLocale: string, availableLocales: string): void {\n    const cur = currentLocale || (this.settings.defaults ? this.settings.defaults['og:locale'] : '');\n\n    if (cur && this.settings.defaults) {\n      this.settings.defaults['og:locale'] = cur.replace(/_/g, '-');\n    }\n\n    // TODO: set HTML lang attribute - https://github.com/ngx-meta/core/issues/32\n    // const html = this.document.querySelector('html');\n    // html.setAttribute('lang', cur);\n\n    const elements = this.meta.getTags('property=\"og:locale:alternate\"');\n\n    elements.forEach((element: any) => {\n      this.meta.removeTagElement(element);\n    });\n\n    if (cur && availableLocales) {\n      availableLocales.split(',').forEach((locale: string) => {\n        if (cur.replace(/-/g, '_') !== locale.replace(/-/g, '_')) {\n          this.meta.addTag({\n            property: 'og:locale:alternate',\n            content: locale.replace(/-/g, '_')\n          });\n        }\n      });\n    }\n  }\n\n  private updateTag(key: string, value: string): void {\n    if (key.lastIndexOf('og:', 0) === 0) {\n      this.meta.updateTag({\n        property: key,\n        content: key === 'og:locale' ? value.replace(/-/g, '_') : value\n      });\n    } else {\n      this.meta.updateTag({\n        name: key,\n        content: value\n      });\n    }\n\n    this.isMetaTagSet[key] = true;\n\n    if (key === 'description') {\n      this.meta.updateTag({\n        property: 'og:description',\n        content: value\n      });\n    } else if (key === 'author') {\n      this.meta.updateTag({\n        property: 'og:author',\n        content: value\n      });\n    } else if (key === 'publisher') {\n      this.meta.updateTag({\n        property: 'og:publisher',\n        content: value\n      });\n    } else if (key === 'og:locale') {\n      const availableLocales = this.settings.defaults ? this.settings.defaults['og:locale:alternate'] : '';\n\n      this.updateLocales(value, availableLocales);\n      this.isMetaTagSet['og:locale:alternate'] = true;\n    } else if (key === 'og:locale:alternate') {\n      const currentLocale = this.meta.getTag('property=\"og:locale\"').content;\n\n      this.updateLocales(currentLocale, value);\n      this.isMetaTagSet['og:locale'] = true;\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, CanActivateChild, RouterStateSnapshot } from '@angular/router';\n\nimport { MetaService } from './meta.service';\n\n@Injectable()\nexport class MetaGuard implements CanActivate, CanActivateChild {\n  constructor(private readonly meta: MetaService) {}\n\n  canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n    const url = state.url;\n\n    const metaSettings = route.hasOwnProperty('data') ? route.data.meta : undefined;\n\n    this.meta.update(url, metaSettings);\n\n    return true;\n  }\n\n  canActivateChild(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean {\n    return this.canActivate(route, state);\n  }\n}\n","import { ModuleWithProviders, NgModule, Optional, SkipSelf } from '@angular/core';\n\nimport { MetaGuard } from './meta.guard';\nimport { MetaLoader, MetaStaticLoader } from './meta.loader';\nimport { MetaService } from './meta.service';\n\nexport const metaFactory = () => new MetaStaticLoader();\n\n@NgModule()\nexport class MetaModule {\n  static forRoot(\n    configuredProvider: any = {\n      provide: MetaLoader,\n      useFactory: metaFactory\n    }\n  ): ModuleWithProviders {\n    return {\n      ngModule: MetaModule,\n      providers: [configuredProvider, MetaGuard, MetaService]\n    };\n  }\n\n  constructor(@Optional() @SkipSelf() parentModule?: MetaModule) {\n    if (parentModule) {\n      throw new Error('MetaModule already loaded; import in root module only.');\n    }\n  }\n}\n"]}